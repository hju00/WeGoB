# [pro] 라인도시건설 문제 풀이

## 문제 설명
- N : 도시 길이(최대 1억 -> 배열 형태 관리를 사전 차단)
- 빌딩은 build() 메서드에서 주어지는 길이만큼 땅을 차지하며, 그 중 가장 왼쪽 셀의 주소가 빌딩의 주소가 됨
- build() : 20_000회, demolish() : 6_000회

### 1. build() : 빌딩 건설
- 빌딩의 주소는 빌딩의 제일 왼쪽 셀의 주소이다.
- 빌딩은 주어진 토지 내 빈 공간 중 가장 긴 공간에 건설한다.(정렬 조건 1)
- 단, 가장 긴 공간이 여러 개라면 그 중 제일 왼쪽에 있는 공간을 선택한다.(정렬 조건 2)
- 공간을 선택하면 빌딩은 그 토지 내 가운데 위치에 건설한다.
- 새로 설치된 빌딩 기준 왼쪽과 오른쪽 빈 공간의 길이가 같거나, 오른쪽의 길이가 1만큼 더 커야 한다.
- 빌딩의 길이 이상의 토지가 존재하지 않으면 빌딩을 설치할 수 없다.

-> 조건 및 우선순위에 맞게 정렬하여 제일 큰 빈 공간을 필요할 때마다 반환해줄 자료구조 필요
-> 우선순위 큐가 제일 적절해 보이나, 삭제 과정의 구현이 어려울 수 있음 -> 지연 삭제의 적용 가능성

### 2. demolish() : 빌딩 철거
- 셀의 주소, 즉 빌딩의 주소가 주어지면 해당 주소를 가진 빌딩을 제거한다.
- 주어진 셀의 주소를 빌딩 주소로 하는 빌딩이 없다면 철거는 불가능하다.
- 셀 주소에 해당하는 빌딩을 제거한다. 그 자리에는 빈 공간만 남는다.
- 만약 빌딩이 철거된 위치의 양 옆에 빈 공간이 또 있다면 남은 빈 토지를 결합한다.

-> 주소를 통해 빌딩을 지정할 수 있는 동시에 양옆의 다른 공간 정보도 확인할 수 있는 자료구조 요구
-> 주소값으로 빌딩을 찾을 수 있는 해시맵, 빌딩 기준 양옆 공간도 확인 가능한 연결 리스트로 구상

## 함수별 세부 
### 1. init(초기화)
- 양 끝의 경계값 및 양방향 노드를 생성하여 이중 연결 리스트 구현
- 먼저 전체 공간을 차지하는 공간 노드를 생성한 후 더미 노드인 head와 tail에 연결
- 초기의 빈 전체 공간을 우선순위 큐에 삽입
- 각 Area는 state를 가짐('a': 빈 공간, 'b': 빌딩, 'd': 삭제된 객체) -> 지연 삭제 적용

### 2. Build(건설)
- 우선순위 큐에서 가장 적합한 빈 공간(max)을 반환 
- 이때 state == 'd'인(이미 병합되거나 쪼개져서 유효하지 않은) 객체는 즉시 제거
- 남은 공간의 길이가 mLength보다 작다면 건설이 불가능하므로 -1 반환
- 중앙 정렬 : 빌딩 설치 후 잔여 공간 계산, 이를 반으로 나눠 왼쪽과 오른쪽 공간의 크기 확정
- 왼쪽 빈 공간(없을 수 있음) - 빌딩 - 오른쪽 빈 공간(없을 수 있음)
- 새로운 빈 공간은 우선순위 큐로, 빌딩은 주소를 key값으로 지정하여 해시맵에 등록

### 3. demolish(철거)
- 주어지는 주소값 mAddr로 해시맵에서 key값이 mAddr와 같은 객체를 찾음. 없으면 -1 반환
- 찾은 빌딩 객체를 해시맵에서 제거
- 양방향 연결리스트를 통해 양쪽의 공간 확인. state == 'a'라면 빈 공간이므로 구간 병합
- 병합에 사용된 구간은 더 이상 사용하면 안되는 객체이므로 state == 'd'로 변경
- 지연 삭제 처리로 인해 우선순위 큐를 사용하더라도 삭제에 대한 부담을 제거
- 병합된 새 공간은 빈 공간이므로 우선순위 큐에 삽입