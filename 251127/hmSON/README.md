# [pro] 단어암기장 문제 풀이

> ## 문제 분석
N행 M열의 셀을 가진 빈 단어장. 셀 하나에 한 글자씩 단어를 적는다. 한 셀 내 글자 중첩을 허용하지 않는다.

단, 하나의 단어를 쓰다가 줄넘김을 하는 것은 허용되지 않는다.

단어를 적는 위치의 우선순위는 다음과 같다.

1. 딘어의 길이 mLen이 주어질 때, 적어도 빈칸의 길이가 mLen 이상인 곳
2. 1번 조건에 해당하는 행이 여러 줄인 경우, 행 번호가 작은 라인
3. 2번 조건에 해당하는 빈 칸이 여러 개일 경우, 열 번호가 작은 빈 칸

즉, 상단 좌측부터 채워야 한다. 어떤 방식으로도 단어를 적을 빈 칸이 없다면 그 단어는 적지 않는다.

***★★★ 한 행에 적혀있는 단어들의 최대 수는 60개 이하임을 보장한다. ★★★***

문제에서 요구하는 쿼리는 2가지

### 1. writeWord(int id, int len) : 단어 작성
- 단어의 ID와 길이가 주어지면 상기한 조건에 부합하는 빈 칸을 찾아 단어를 작성한다.
- ID를 인덱스로 하는 DB형 자료구조 요구
- 호출 횟수 50_000, N의 최대 크기는 20_000이므로 순차 탐색으로 순회하면 시간 초과를 마주할 것이다.
    - 즉, 적어도 O(log N) 또는 O(1) 수준의 최적의 값을 탐색하는 알고리즘을 요구한다.
    - 한 행에 적는 단어는 최대 60개, (단어 <-> 빈 칸)이 돌아가면서 반복되는 구조라고 해도 한 행 내부를 순회하는 것은 120회 이하임이 보장된다.
    - 어떻게든 빠르게 최적의 행을 찾기만 한다면 이후의 과정은 큰 시간을 소모하지 않는다는 의미이다.
- 단어 작성에 성공하면 그 단어를 작성한 행의 번호를, 단어 작성에 실패하면 -1을 반환한다.

### 2. eraseWord(int id) : 단어 제거
- 주어지는 ID에 해당하는 단어를 찾아 지운다. 없거나 이미 삭제된 경우 -1을 반환한다.
- 단어 ID 범위 외의 값이 파라미터로 주어질 수 있다.
    - writeWord()에서 주어지는 ID 값은 최대 50_000
    - eraseWord()에서 주어지는 ID 값은 최대 55_000
    - 즉, eraseWord()에서 주어지는 ID 값이 50000을 초과하는 경우도 마찬가지로 -1을 반환한다.
- 찾은 단어는 지우고, 그 위치는 다시 빈 칸이 된다.
    - 지운 단어의 양 옆에 빈 칸이 존재하는 경우 하나의 큰 빈 칸 구간이 만들어질 수 있을 것이다.
    - 즉, 지우려는 단어를 기준으로 양 옆을 즉시 확인할 수 있는 자료구조가 요구된다.
- 그리고 그 단어가 있었던 행의 번호를 반환한다.

<br><br>

> ## 자료구조 및 알고리즘 설계
### 1. 단어 DB
- 단어의 ID를 인덱스로 가지는 자료구조가 요구된다. 
- 작성되는 단어의 ID 최대값은 50_000이므로 배열과 HashMap 모두 사용 가능하다.

### 2. 세그먼트 트리
- 초기에 생각한 알고리즘은 매개변수 탐색(Parametric Search)이다. 일정 범위 내에서 조건에 부합하는 최적해를 찾는 대표적인 알고리즘이기 때문이다. 시간복잡도 또한 O(log N)이 보장된다.
- 그러나 투 포인터 기반 알고리즘인 매개변수 탐색의 특성상 리스트 정렬이 반드시 요구된다. 따라서 매개변수 탐색은 폐기.
- 대신 O(log N)으로 최적해를 찾을 수 있으면서도 내부 값 변화에 유연하게 대처할 수 있는 "세그먼트 트리(Segment Tree)"가 이 문제에 적합할 것이라고 판단했다.

- 리프 노드에는 각 행별 가장 큰 빈 칸의 길이를 기록해두고, 상위 노드에는 구간별 최대값을 기록한다.
- 최적해를 찾을 때에는 루트 노드부터 시작하여 길이가 len 이상이면서 행 인덱스가 제일 낮은 위치를 찾는다.

### 3. 연결 리스트
- 일단 최적해를 가진 행을 찾기만 하면, 길이가 len 이상이면서 열 번호가 제일 낮은 빈 칸의 위치를 찾는 것은 순차 탐색으로 찾아도 실행 시간 관점에서 문제가 없다. 최대 120회가 보장되기 때문이다.
- 따라서 어떤 리스트 구조를 사용해도 상관없으나, 삽입/삭제가 빈번한 문제이므로 연결 리스트를 직접 구현한다.
- 이중 연결리스트로 구성하면 단어 삭제시 양 옆의 구간도 즉시 찾을 수 있다.